<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="PieGlyph">
<title>Pie-chart lollipop plots • PieGlyph</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Pie-chart lollipop plots">
<meta property="og:description" content="PieGlyph">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">PieGlyph</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/PieGlyph.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/time-series-example.html">Time-series example</a>
    <a class="dropdown-item" href="../articles/spatial-example.html">Spatial data example</a>
    <a class="dropdown-item" href="../articles/pie-lollipop-example.html">Pie-chart lollipop plots</a>
    <a class="dropdown-item" href="../articles/compositions-example.html">Compositional data example</a>
    <a class="dropdown-item" href="../articles/unusual-situations.html">Unusual situations</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/rishvish/PieGlyph/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Pie-chart lollipop plots</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/rishvish/PieGlyph/blob/HEAD/vignettes/pie-lollipop-example.Rmd" class="external-link"><code>vignettes/pie-lollipop-example.Rmd</code></a></small>
      <div class="d-none name"><code>pie-lollipop-example.Rmd</code></div>
    </div>

    
    
<style type="text/css">
body {
  text-align: justify;
}

p {
  font-weight: 'normal';
  font-size: '16px;
  text-align: justify;
}
</style>
<p>
This example shows the use of <code>PieGlyph</code> package to create
lollipop plots where the centre of the lollipop is replaced by a
pie-chart showing proportion of different attributes.
</p>
<p>
The example is set up to showcase that even if the attributes to be
shown in the pie-charts are not in proportions or percentages, the
function would calculate those automatically. Further the attributes
don’t always have to be in separate columns, they can also be stacked in
one column with their corresponding values in another column.
</p>
<div class="section level3">
<h3 id="load-libraries">Load libraries<a class="anchor" aria-label="anchor" href="#load-libraries"></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">PieGlyph</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="simulate-fake-data">Simulate fake data<a class="anchor" aria-label="anchor" href="#simulate-fake-data"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="st">'ID'</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'P'</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">)</span>,</span>
<span>                         <span class="st">'A'</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">90</span>, <span class="fl">60</span>, <span class="fl">30</span>, <span class="fl">75</span>, <span class="fl">85</span>, </span>
<span>                                 <span class="fl">30</span>, <span class="fl">50</span>, <span class="fl">70</span>, <span class="fl">65</span>, <span class="fl">65</span>, </span>
<span>                                 <span class="fl">40</span>, <span class="fl">115</span>, <span class="fl">165</span>, <span class="fl">40</span>, <span class="fl">175</span>, </span>
<span>                                 <span class="fl">200</span>, <span class="fl">185</span>, <span class="fl">250</span>, <span class="fl">190</span>, <span class="fl">175</span><span class="op">)</span>,</span>
<span>                         <span class="st">'B'</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">170</span>, <span class="fl">180</span>, <span class="fl">130</span>, <span class="fl">325</span>, <span class="fl">180</span>,</span>
<span>                                 <span class="fl">220</span>, <span class="fl">335</span>, <span class="fl">285</span>, <span class="fl">85</span>, <span class="fl">125</span>,</span>
<span>                                 <span class="fl">250</span>, <span class="fl">190</span>, <span class="fl">60</span>, <span class="fl">205</span>, <span class="fl">125</span>, </span>
<span>                                 <span class="fl">90</span>, <span class="fl">95</span>, <span class="fl">25</span>, <span class="fl">60</span>, <span class="fl">20</span><span class="op">)</span>,</span>
<span>                         <span class="st">'C'</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">60</span>, <span class="fl">35</span>, <span class="fl">95</span>, <span class="fl">50</span>, <span class="fl">15</span>, </span>
<span>                                 <span class="fl">190</span>, <span class="fl">15</span>, <span class="fl">80</span>, <span class="fl">310</span>, <span class="fl">280</span>, </span>
<span>                                 <span class="fl">185</span>, <span class="fl">115</span>, <span class="fl">220</span>, <span class="fl">190</span>, <span class="fl">155</span>, </span>
<span>                                 <span class="fl">135</span>, <span class="fl">180</span>, <span class="fl">120</span>, <span class="fl">100</span>, <span class="fl">140</span><span class="op">)</span>,</span>
<span>                         <span class="st">'D'</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">180</span>, <span class="fl">225</span>, <span class="fl">245</span>, <span class="fl">50</span>, <span class="fl">220</span>, </span>
<span>                                 <span class="fl">60</span>, <span class="fl">100</span>, <span class="fl">65</span>, <span class="fl">40</span>, <span class="fl">30</span>, </span>
<span>                                 <span class="fl">25</span>, <span class="fl">80</span>, <span class="fl">55</span>, <span class="fl">65</span>, <span class="fl">45</span>,</span>
<span>                                 <span class="fl">75</span>, <span class="fl">30</span>, <span class="fl">105</span>, <span class="fl">150</span>, <span class="fl">165</span><span class="op">)</span>,</span>
<span>                         <span class="st">'Disease'</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Yes'</span><span class="op">)</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>                                              <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'No'</span><span class="op">)</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>
The data contains proportions of four protein markers in the blood for
20 different patients. <code>ID</code> is a unique identifier for each
patients while columns <code>A</code>, <code>B</code>, <code>C</code>,
and <code>D</code> describe the scores of each patient across the four
markers and <code>disease</code> describes whether of not the patient
has a disease
</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">model_data</span><span class="op">)</span></span>
<span><span class="co">#&gt;   ID  A   B   C   D Disease</span></span>
<span><span class="co">#&gt; 1 P1 90 170  60 180     Yes</span></span>
<span><span class="co">#&gt; 2 P2 60 180  35 225     Yes</span></span>
<span><span class="co">#&gt; 3 P3 30 130  95 245     Yes</span></span>
<span><span class="co">#&gt; 4 P4 75 325  50  50     Yes</span></span>
<span><span class="co">#&gt; 5 P5 85 180  15 220     Yes</span></span>
<span><span class="co">#&gt; 6 P6 30 220 190  60     Yes</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="fit-regression-model">Fit regression model<a class="anchor" aria-label="anchor" href="#fit-regression-model"></a>
</h3>
<p>
We fit a logistic regression model using the four protein markers as
predictors for the probability of having the disease
</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">Disease</span> <span class="op">~</span> <span class="va">A</span> <span class="op">+</span> <span class="va">B</span> <span class="op">+</span> <span class="va">C</span> <span class="op">+</span> <span class="va">D</span> <span class="op">+</span> <span class="fl">0</span>,</span>
<span>          data <span class="op">=</span> <span class="va">model_data</span>,</span>
<span>          family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">'logit'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>
The model summary shows that marker <code>A</code> is significant in
predicting the probability of having the disease.
</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; glm(formula = Disease ~ A + B + C + D + 0, family = binomial(link = "logit"), </span></span>
<span><span class="co">#&gt;     data = model_data)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Deviance Residuals: </span></span>
<span><span class="co">#&gt;      Min        1Q    Median        3Q       Max  </span></span>
<span><span class="co">#&gt; -1.95542  -0.26818   0.00974   0.49409   1.18935  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;    Estimate Std. Error z value Pr(&gt;|z|)  </span></span>
<span><span class="co">#&gt; A -0.035561   0.018041  -1.971   0.0487 *</span></span>
<span><span class="co">#&gt; B  0.005089   0.004897   1.039   0.2987  </span></span>
<span><span class="co">#&gt; C  0.003451   0.005785   0.597   0.5508  </span></span>
<span><span class="co">#&gt; D  0.022697   0.015913   1.426   0.1538  </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; (Dispersion parameter for binomial family taken to be 1)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     Null deviance: 27.726  on 20  degrees of freedom</span></span>
<span><span class="co">#&gt; Residual deviance: 13.221  on 16  degrees of freedom</span></span>
<span><span class="co">#&gt; AIC: 21.221</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of Fisher Scoring iterations: 6</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="model-predictions">Model predictions<a class="anchor" aria-label="anchor" href="#model-predictions"></a>
</h3>
<p>
We can now predict the probability of a patient having the disease give
their scores on the four protein markers.
</p>
<p>
After making the predictions, the data is sorted in descending order of
the probability of having the disease. Further the marker columns are
stacked together into one column.
</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plot_data</span> <span class="op">&lt;-</span> <span class="va">model_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># Add predictions</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="st">'prediction'</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">m1</span>, type <span class="op">=</span> <span class="st">'response'</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># Sort in descending order of prediction</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="va">prediction</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="co"># Relevel ID for plotting in descending order</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>ID <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_inorder.html" class="external-link">fct_inorder</a></span><span class="op">(</span><span class="va">ID</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="co"># Stack the four markers in one column</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'A'</span>, <span class="st">'B'</span>, <span class="st">'C'</span>,<span class="st">'D'</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">'Marker'</span>,</span>
<span>               values_to <span class="op">=</span> <span class="st">'Proportion'</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">plot_data</span>, <span class="fl">8</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 8 × 5</span></span></span>
<span><span class="co">#&gt;   ID    Disease prediction Marker Proportion</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> P3    Yes          0.996 A              30</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> P3    Yes          0.996 B             130</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> P3    Yes          0.996 C              95</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> P3    Yes          0.996 D             245</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> P2    Yes          0.982 A              60</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> P2    Yes          0.982 B             180</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">7</span> P2    Yes          0.982 C              35</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">8</span> P2    Yes          0.982 D             225</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="bar-plot">Bar plot<a class="anchor" aria-label="anchor" href="#bar-plot"></a>
</h3>
<p>
The probability of each patient in our sample having the disease can be
visualised with a bar chart as follows.
</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">plot_data</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">ID</span>, y <span class="op">=</span> <span class="va">prediction</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="co"># Add axis titles</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">'Prob(Having Disease)'</span>, x <span class="op">=</span> <span class="st">'Patient'</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="co"># Values to show on y-axis</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="pie-lollipop-example_files/figure-html/barplot-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="lollipop-plot-with-pie-charts">Lollipop plot with pie-charts<a class="anchor" aria-label="anchor" href="#lollipop-plot-with-pie-charts"></a>
</h3>
<p>
The bar plot is not that useful in this example as it gives only the
probability of having the disease and gives no information about the
model predictors (scores for protein markers in this case).
</p>
<p>
We can improve this plot by converting it into a lollipop plot where the
centre of the lollipop shows the proportions of the four protein
markers. This enables us to view both, the response as well as the
predictors for model simultaneously.
</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">plot_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">ID</span>, y <span class="op">=</span> <span class="va">prediction</span>, fill <span class="op">=</span> <span class="va">Marker</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="co"># Vertical line of lollipop</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html" class="external-link">geom_segment</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>yend <span class="op">=</span> <span class="fl">0</span>, xend <span class="op">=</span> <span class="va">ID</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="co"># Pies-charts at the centre of the lollipop</span></span>
<span>  <span class="fu"><a href="../reference/geom_pie_glyph.html">geom_pie_glyph</a></span><span class="op">(</span>categories <span class="op">=</span> <span class="st">'Marker'</span>, values <span class="op">=</span> <span class="st">'Proportion'</span>,</span>
<span>                 radius <span class="op">=</span> <span class="fl">0.6</span>, colour <span class="op">=</span> <span class="st">'black'</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="co"># Axis titles</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">'Prob(Having Disease)'</span>, x <span class="op">=</span> <span class="st">'Patient'</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="co"># Colours for sectors of the pie-chart</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'#56B4E9'</span>,<span class="st">'#F0E442'</span>,</span>
<span>                               <span class="st">'#D55E00'</span>,<span class="st">'#CC79A7'</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="pie-lollipop-example_files/figure-html/lollipop-1.png" width="672" style="display: block; margin: auto;"></p>
<p><br><br></p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Rishabh Vishwakarma, Catherine Hurley, Caroline Brophy.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
